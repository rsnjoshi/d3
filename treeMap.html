<html>

<head>
    <title>Tree Map</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>

<body>
    <script>
        let data = {
            name: "food",
            children: [
                {
                    name: "mitho",
                    children: [
                        { name: "aloo" },
                        { name: 'masu' },
                        { name: 'anda' },
                        { name: 'noodles' },
                        { name: 'momo' }
                    ]
                },
                {
                    name: "namitho",
                    children: [
                        { name: "ghiraula" },
                        { name: "karela" },
                        { name: "lauka" },
                        { name: 'bakula' }
                    ]
                }
            ]
        }

        let root = d3.hierarchy(data)
        const tree = d3.tree().nodeSize([50, 200])
        tree(root)
        console.log(root)
        let links = root.links()
        console.log(links)
        let descendants = root.descendants()
        console.log(descendants)

        let diagonal = d3.linkHorizontal().x(d => d.y).y(d => d.x)

        const svg = d3.select('body').append("svg")
            .attr("width", 1000)
            .attr("height", 1000)

        const gLink = svg.append("g")
            .attr("fill", "none")
            .attr("stroke", "#555")
            .attr("stroke-opacity", 1)
            .attr("stroke-width", 1.5)
            .attr('transform', 'translate(500, 500)')

        const link = gLink.selectAll("path")
            .data(links)
            .enter()
            .append('path')
            .attr('d', function (d) {
                return diagonal(d)
            })
        const dots = gLink.selectAll("circle")
            .data(descendants)
            .enter()
            .append('circle')
            .attr('cx', d => d.y)
            .attr('cy', d => d.x)
            .attr('r', 4)
            .attr('fill', 'red')

        const text = gLink.selectAll('text')
            .data(descendants)
            .enter()
            .append('text')
            .text(d => d.data.name)
            .attr('x', d => {
                if (!d.children) {
                    return d.y + 3
                } else {
                    return d.y - 10
                }
            })
            .attr('y', d => d.x - 3)
            .attr('stroke', 'black')

    </script>

</body>

</html>